<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="作者：给立乐*出处：http://spencer-dev.com/2016/04/24/树莓派使用记录声明：本文采用以下协议进行授权： 自由转载-非商用-非衍生-保持署名|Creative Commons BY-NC-ND 3.0 ，转载请注明作者及出处。
树莓派使用记录系统下载和安装raspbia">
    

    <!--Author-->
    
        <meta name="author" content="Spencer">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="树莓派使用记录"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="给立乐*"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>树莓派使用记录 - 给立乐*</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-65158169-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">给立乐* Android 开发者</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/ChinaSunHZ/">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>树莓派使用记录</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2016-04-24 02:44
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/Raspberry-Pi/">#Raspberry Pi</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>作者：给立乐*<br>出处：<a href="http://spencer-dev.com/2016/04/24/树莓派使用记录">http://spencer-dev.com/2016/04/24/树莓派使用记录</a><br>声明：本文采用以下协议进行授权： 自由转载-非商用-非衍生-保持署名|<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" rel="external">Creative Commons BY-NC-ND 3.0</a> ，转载请注明作者及出处。</p>
<h1 id="树莓派使用记录"><a href="#树莓派使用记录" class="headerlink" title="树莓派使用记录"></a>树莓派使用记录</h1><h2 id="系统下载和安装"><a href="#系统下载和安装" class="headerlink" title="系统下载和安装"></a><a href="http://shumeipai.nxez.com/2014/05/18/raspberry-pi-under-mac-osx-to-install-raspbian-system.html" target="_blank" rel="external">系统下载和安装</a></h2><p><a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="external">raspbian系统下载地址</a></p>
<p>用df命令查看当前已挂载的卷：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -h</div></pre></td></tr></table></figure>
<p>找到需要写入镜像的卷后，卸载它：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diskutil unmount /dev/disk1s1 #(这里可能是其他名字)</div></pre></td></tr></table></figure>
<p>使用dd命令将系统镜像写入：</p>
<p><strong>需要特别特别注意disk后的数字，不能搞错！（说明：/dev/disk1s1是分区，/dev/disk1是块设备，/dev/rdisk1是原始字符设备）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dd bs=4m if=2016-03-18-raspbian-jessie.img of=/dev/rdisk1</div></pre></td></tr></table></figure>
<p>经过几分钟的等待，出现下面的提示，说明 SD 卡刷好了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">462+1 records in</div><div class="line">462+1 records out</div><div class="line">1939865600 bytes transferred in 163.133220 secs (11891297 bytes/sec)</div></pre></td></tr></table></figure>
<p>刷好之后卸载 SD 卡：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diskutil unmountDisk /dev/disk1</div></pre></td></tr></table></figure>
<p>这时候把 SD 卡插进树莓派，然后接通电源，树莓派就能正常启动进入系统了。</p>
<hr>
<h2 id="SSH-设置-WIFI"><a href="#SSH-设置-WIFI" class="headerlink" title="SSH 设置 WIFI"></a><a href="http://www.cnblogs.com/scgw/p/3947980.html" target="_blank" rel="external">SSH 设置 WIFI</a></h2><p>通过配置 /etc/network/interfaces 文件实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/network/interfaces</div></pre></td></tr></table></figure></p>
<p>修改后文件内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line"></div><div class="line">iface lo inet loopback</div><div class="line">iface eth0 inet dhcp</div><div class="line"></div><div class="line">auto wlan0</div><div class="line">allow-hotplug wlan0</div><div class="line">iface wlan0 inet dhcp</div><div class="line">wpa-ssid &quot;你的 wifi 名称&quot;</div><div class="line">wpa-psk &quot;你的 wifi 密码&quot;</div><div class="line"></div><div class="line">具体各行配置的意思如下:</div><div class="line">auto lo //表示使用 localhost</div><div class="line">iface eth0 inet dhcp //表示如果有网卡 ech0, 则用 DHCP 获得 IP 地址 (这个网卡是本机的网卡，而不是 WIFI 网卡)</div><div class="line">auto wlan0 //表示如果有wlan设备，使用wlan0设备名</div><div class="line">allow-hotplug wlan0 //表示wlan设备可以热插拨</div><div class="line">iface wlan0 inet dhcp //表示如果有 WLAN 网卡 wlan0 (就是 WIFI 网卡), 则用 DHCP 获得 IP 地址</div><div class="line"></div><div class="line">wpa-ssid &quot;你的 wifi 名称&quot;//表示连接SSID名</div><div class="line">wpa-psk &quot;你的 wifi 密码&quot;//表示连接WIFI网络时，使用 wpa-psk 认证方式，认证密码</div></pre></td></tr></table></figure></p>
<p>上述定义后，如果有网线连接，则采取 DHCP 自动连接获得地址。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/networking restart</div></pre></td></tr></table></figure></p>
<p>成功后，用 ifconfig 命令可以看到 wlan0 设备，且有了 IP 地址(已连接)</p>
<hr>
<h2 id="VNC-远程登录树莓派的图形界面"><a href="#VNC-远程登录树莓派的图形界面" class="headerlink" title="VNC 远程登录树莓派的图形界面"></a><a href="http://shumeipai.nxez.com/2013/09/04/login-rpi-with-vnc.html?variant=zh-cn" target="_blank" rel="external">VNC 远程登录树莓派的图形界面</a></h2><h3 id="安装-VNC"><a href="#安装-VNC" class="headerlink" title="安装 VNC"></a>安装 VNC</h3><p>用 SSH 登录树莓派后，执行命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install tightvncserver</div></pre></td></tr></table></figure></p>
<p>安装好之后请一定先使用此命令设置一个 VNC 密码：<br>（先输入操作密码两次，然后会询问是否设置一个查看(view-only)密码，按自己喜欢，一般没必要。）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vncpasswd</div></pre></td></tr></table></figure></p>
<h3 id="开机自动启动"><a href="#开机自动启动" class="headerlink" title="开机自动启动"></a>开机自动启动</h3><p>设置开机启动，需要在 /etc/init.d/ 中创建一个文件。例如 tightvncserver：<br>（注：启动脚本的名称，有和程序名一致的习惯）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/init.d/tightvncserver</div></pre></td></tr></table></figure></p>
<p>内容如下：<br><strong>注：少数玩家默认用户不是pi的请自行更改 USER 变量</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">### BEGIN INIT INFO</div><div class="line"># Provides:          tightvncserver</div><div class="line"># Required-Start:    $local_fs</div><div class="line"># Required-Stop:     $local_fs</div><div class="line"># Default-Start:     2 3 4 5</div><div class="line"># Default-Stop:      0 1 6</div><div class="line"># Short-Description: Start/stop tightvncserver</div><div class="line">### END INIT INFO</div><div class="line"> </div><div class="line"># More details see:</div><div class="line"># http://www.penguintutor.com/linux/tightvnc</div><div class="line"> </div><div class="line">### Customize this entry</div><div class="line"># Set the USER variable to the name of the user to start tightvncserver under</div><div class="line">export USER=&apos;pi&apos;</div><div class="line">### End customization required</div><div class="line"> </div><div class="line">eval cd ~$USER</div><div class="line"> </div><div class="line">case &quot;$1&quot; in</div><div class="line">  start)</div><div class="line">    # 启动命令行。此处自定义分辨率、控制台号码或其它参数。</div><div class="line">    su $USER -c &apos;/usr/bin/tightvncserver -depth 16 -geometry 800x600 :1&apos;</div><div class="line">    echo &quot;Starting TightVNC server for $USER &quot;</div><div class="line">    ;;</div><div class="line">  stop)</div><div class="line">    # 终止命令行。此处控制台号码与启动一致。</div><div class="line">    su $USER -c &apos;/usr/bin/tightvncserver -kill :1&apos;</div><div class="line">    echo &quot;Tightvncserver stopped&quot;</div><div class="line">    ;;</div><div class="line">  *)</div><div class="line">    echo &quot;Usage: /etc/init.d/tightvncserver &#123;start|stop&#125;&quot;</div><div class="line">    exit 1</div><div class="line">    ;;</div><div class="line">esac</div><div class="line">exit 0</div></pre></td></tr></table></figure></p>
<p>按 Ctrl+X，回答Y（存盘）退出 nano 编辑器。</p>
<p>然后给 tightvncserver 文件加执行权限，并更新开机启动列表。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo chmod 755 /etc/init.d/tightvncserver</div><div class="line">sudo update-rc.d tightvncserver defaults</div></pre></td></tr></table></figure></p>
<p>启动 VNC 控制台：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vncserver :1</div></pre></td></tr></table></figure></p>
<p>终止 VNC 控制台：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tightvncserver -kill :1</div></pre></td></tr></table></figure></p>
<p>查看正在运行的控制台列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps ax | grep Xtightvnc | grep -v grep</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="树莓派支持中文"><a href="#树莓派支持中文" class="headerlink" title="树莓派支持中文"></a><a href="http://shumeipai.nxez.com/2013/09/04/login-rpi-with-vnc.html?variant=zh-cn" target="_blank" rel="external">树莓派支持中文</a></h2><h3 id="安装中文字库"><a href="#安装中文字库" class="headerlink" title="安装中文字库"></a>安装中文字库</h3><p>安装中文字库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install ttf-wqy-zenhei</div></pre></td></tr></table></figure></p>
<h3 id="安装输入法"><a href="#安装输入法" class="headerlink" title="安装输入法"></a>安装输入法</h3><p>安装中文拼音输入法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install scim-pinyin</div></pre></td></tr></table></figure></p>
<p>安装中文五笔输入法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install scim-tables-zh</div></pre></td></tr></table></figure></p>
<h3 id="配置树莓派"><a href="#配置树莓派" class="headerlink" title="配置树莓派"></a>配置树莓派</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo raspi-config</div></pre></td></tr></table></figure>
<p>然后选择 change_locale，在 Default locale for the system environment: 中选择 zh_CN.UTF-8</p>
<p>重启完成好就可以显示中文和使用中文输入法了，切换中文输入法一样也是 ctrl + space。</p>
<hr>
<h2 id="使用-screen-保留-SSH-会话"><a href="#使用-screen-保留-SSH-会话" class="headerlink" title="使用 screen 保留 SSH 会话"></a><a href="http://www.cnblogs.com/mchina/archive/2013/01/30/2880680.html" target="_blank" rel="external">使用 screen 保留 SSH 会话</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install screen</div></pre></td></tr></table></figure>
<hr>
<h2 id="perl-warning-Setting-locale-failed-问题"><a href="#perl-warning-Setting-locale-failed-问题" class="headerlink" title="perl: warning: Setting locale failed. 问题"></a><a href="#">perl: warning: Setting locale failed. 问题</a></h2><p><strong><em>( - - 反正我的树莓派这样设置一下就正常了。。还是不正常的话别怪我。)</em></strong></p>
<p>执行命令，查看本地的当前设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">locale</div></pre></td></tr></table></figure>
<p>有可能会出现的情况是 LANGUAGE 和 LC_ALL 为空。所以导致每次执行命令时都会出现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">perl: warning: Setting locale failed.   </div><div class="line">perl: warning: Please check that your locale settings:   </div><div class="line">        LANGUAGE = (unset),</div><div class="line">        LC_ALL = (unset),</div><div class="line">        LC_MESSAGES = &quot;en_US.UTF-8&quot;,   </div><div class="line">        LANG = &quot;en_US.UTF-8&quot;</div></pre></td></tr></table></figure></p>
<p>解决办法：<br>通过 VNC 连接到树莓派之后，找到桌面右上角的 『Menu』 -&gt; 『Preferences』 -&gt; 『Raspberry Pi Configuration』。<br>然后在弹出的 『Raspberry Pi Configuration』 窗口中找到 『Localisation』 -&gt; 『Set Locale…』。</p>
<p>接着在弹出的 『Locale』 窗口中的 『Language』 选项中选择 『en(English)』， 『Country』 选项中选择 『US(USA)』，在 『Character Set』 选项中选择 『UTF-8』。</p>
<p>设置完成后，会提示是否重启电脑。选择：是。<br>电脑重启后重新运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">locale</div></pre></td></tr></table></figure>
<p>发现结果和上面一样，LANGUAGE 和 LC_ALL 还是为空。<br>这时候需要手动设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">export LANGUAGE=en_US</div><div class="line">export LC_ALL=en_US</div><div class="line">source /etc/default/locale</div></pre></td></tr></table></figure></p>
<p>这时候在执行命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">locale</div></pre></td></tr></table></figure></p>
<p>会发现最后的结果变成下面的样子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">LANG=en_US</div><div class="line">LANGUAGE=en_US</div><div class="line">LC_CTYPE=&quot;en_US&quot;</div><div class="line">LC_NUMERIC=&quot;en_US&quot;</div><div class="line">LC_TIME=&quot;en_US&quot;</div><div class="line">LC_COLLATE=&quot;en_US&quot;</div><div class="line">LC_MONETARY=&quot;en_US&quot;</div><div class="line">LC_MESSAGES=&quot;en_US&quot;</div><div class="line">LC_PAPER=&quot;en_US&quot;</div><div class="line">LC_NAME=&quot;en_US&quot;</div><div class="line">LC_ADDRESS=&quot;en_US&quot;</div><div class="line">LC_TELEPHONE=&quot;en_US&quot;</div><div class="line">LC_MEASUREMENT=&quot;en_US&quot;</div><div class="line">LC_IDENTIFICATION=&quot;en_US&quot;</div><div class="line">LC_ALL=en_US</div></pre></td></tr></table></figure></p>
<p>这样就正常了。</p>
<hr>
<h2 id="树莓派开启-FTP-服务并挂载移动硬盘-NTFS"><a href="#树莓派开启-FTP-服务并挂载移动硬盘-NTFS" class="headerlink" title="树莓派开启 FTP 服务并挂载移动硬盘(NTFS)"></a>树莓派开启 FTP 服务并挂载移动硬盘(NTFS)</h2><h3 id="安装并开启-FTP服务"><a href="#安装并开启-FTP服务" class="headerlink" title="安装并开启 FTP服务"></a>安装并开启 FTP服务</h3><p>安装 FTP 服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install vsftpd</div></pre></td></tr></table></figure>
<p>然后配置 vsftpd 服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/vsftpd.conf</div></pre></td></tr></table></figure>
<p>在配置文件中找到以下字段，并设置为下面的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">anonymous_enable=NO # 表示不允许匿名访问。</div><div class="line">local_enable=YES # 设定本地用户可以访问。</div><div class="line">write_enable=YES # 设定可以进行写操作。</div><div class="line">local_umask=022 # 支持断点续传。</div><div class="line">write_enable=YES # 要检查一下这个字段，因为有可能开始的时候是被注释掉的。</div></pre></td></tr></table></figure>
<p>配置成功后，重启 FTP 服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service vsftpd restart</div></pre></td></tr></table></figure>
<h3 id="挂载移动硬盘-NTFS"><a href="#挂载移动硬盘-NTFS" class="headerlink" title="挂载移动硬盘(NTFS)"></a>挂载移动硬盘(NTFS)</h3><p>使用命令查看磁盘信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -lh</div></pre></td></tr></table></figure>
<p>找到自己的磁盘，并记下磁盘名称。</p>
<p>例如我自己的移动硬盘磁盘名称：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/dev/sda1</div></pre></td></tr></table></figure>
<h4 id="如何挂载和卸载"><a href="#如何挂载和卸载" class="headerlink" title="如何挂载和卸载"></a>如何挂载和卸载</h4><h5 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h5><p>因为我自己挂载到 home/pi/[User Name] 目录下了。所以这里也以这个举例子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~</div><div class="line">mkdir [你想创建的文件夹名字] </div><div class="line"># 例如：mkdir my_folder</div></pre></td></tr></table></figure>
<p>挂载移动硬盘到指定目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mount -t ntfs-3g /dev/sda1 /home/pi/[已存在的文件夹] </div><div class="line"># 例如：sudo mount -t ntfs-3g /dev/sda1 /home/pi/my_folder</div></pre></td></tr></table></figure>
<h5 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">umount /dev/sda1</div></pre></td></tr></table></figure>
<p><strong>注：移动硬盘连接到树莓派之后，树莓派有可能会自动挂载。（例如我的树莓派3）。</strong></p>
<p>如果自动挂载了，再输入挂载命令之后就会报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Mount is denied because the NTFS volume is already exclusively opened.The volume may be already mounted,or another software may use it which could be identified for example by the help of the &quot;fuser&quot;command.</div></pre></td></tr></table></figure>
<p><strong>如果出现这个问题，请手动卸载后，重新挂载。</strong></p>
<hr>
<h2 id="安装-Tomcat-并配置环境变量"><a href="#安装-Tomcat-并配置环境变量" class="headerlink" title="安装 Tomcat 并配置环境变量"></a>安装 Tomcat 并配置环境变量</h2><h3 id="下载并安装"><a href="#下载并安装" class="headerlink" title="下载并安装"></a>下载并安装</h3><p>首先要去官网下载一个自己所需要的版本的 Tomcat，我下载的是 Tomcat-8.0.33。<br>(Tomcat 下载地址)[<a href="http://tomcat.apache.org/" target="_blank" rel="external">http://tomcat.apache.org/</a>]<br>从下载选项中选择 tar.gz。<br>下载完成后，可以通过两种方式解压。</p>
<ul>
<li><p>直接用命令行解压：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar xzf apache-tomcat-8.0.33.tar.gz</div></pre></td></tr></table></figure>
</li>
<li><p>如果已经连接了 VNC 可以直接双击进入目录后拖拽到目标文件夹或右键导出。</p>
</li>
</ul>
<h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>记录好 Tomcat 的安装路径。</p>
<p>编辑系统环境变量配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/profile</div></pre></td></tr></table></figure>
<p>打开文件后，在文件的末尾加入 Tomcat 的环境变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">TOMCAT=[Tomcat 的安装路径]</div><div class="line"># 例如：TOMCAT=/home/pi/dev_tools/apache_tomcat_8/bin</div><div class="line">export TOMCAT</div><div class="line">export PATH=$PATH:TOMCAT</div></pre></td></tr></table></figure>
<p>环境变量配置成功之后，立马执行 startup.sh 或者 shutdown.sh 是没效果的。会提示错误：找不到命令。</p>
<p>需要重启系统( sudo reboot )才可以执行 startup.sh 或 shutdown.sh。（本来我以为执行 source /etc/profile 刷新 profile 文件就行，但是尝试过后发现不可以。）</p>
<hr>
<h2 id="安装并配置-Nginx"><a href="#安装并配置-Nginx" class="headerlink" title="安装并配置 Nginx"></a><a href="http://www.mkyong.com/nginx/nginx-apache-tomcat-configuration-example/" target="_blank" rel="external">安装并配置 Nginx</a></h2><h3 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install nginx</div></pre></td></tr></table></figure>
<p>启动 Nginx：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/nginx start</div></pre></td></tr></table></figure>
<p>让 Nginx 重新加载配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/nginx reload</div></pre></td></tr></table></figure>
<h3 id="配置-Nginx"><a href="#配置-Nginx" class="headerlink" title="配置 Nginx"></a>配置 Nginx</h3><p>没有特意配置 Tomcat，只是配置了 Nginx 向 Tomcat 的 8080 端口的代理。<br>编辑 Nginx 的配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/nginx/sites-enabled/default</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">  listen          80;</div><div class="line">  server_name     yourdomain.com;</div><div class="line">  root            /etc/tomcat7/webapps/apple;</div><div class="line"></div><div class="line">  proxy_cache one;</div><div class="line"></div><div class="line">  location / &#123;</div><div class="line">        proxy_set_header X-Forwarded-Host <span class="variable">$host</span>;</div><div class="line">        proxy_set_header X-Forwarded-Server <span class="variable">$host</span>;</div><div class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">        proxy_pass http://127.0.0.1:8080/;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在 location / { xxx } 里面添加一行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">proxy_pass http://127.0.0.1:8080/[这里可以加自己的项目，以便直接连过去];</div><div class="line"><span class="comment"># 例如：proxy_pass http://localhost:8080/RaspberryWebServer/;</span></div><div class="line"><span class="comment"># 或者只写 proxy_pass http://localhost:8080/; 也可以</span></div></pre></td></tr></table></figure></p>
<hr>
<h2 id="系统备份和还原"><a href="#系统备份和还原" class="headerlink" title="系统备份和还原"></a><a href="http://www.360doc.com/content/13/1114/10/8744436_329089611.shtml" target="_blank" rel="external">系统备份和还原</a></h2><p>将树莓派关机后，取下 SD 卡，插入到电脑中（我的是 Mac 所以直接使用命令行操作）。</p>
<p>首先查看 SD 卡信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -h</div></pre></td></tr></table></figure>
<p>看到自己的 SD 卡之后，记录下挂载路径和名字。</p>
<h3 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h3><p>使用命令来备份（可能会时间比较久我的大概备份了一个小时）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo dd if=[SD 卡的名字] | gzip&gt;[备份后的文件存储路径以及文件名]</div><div class="line"># 例如：sudo dd if=/dev/disk2 | gzip&gt;~/Documents/raspberry_system_back/system_save_14_04_24.gz</div></pre></td></tr></table></figure>
<p>备份完之后，文件是后缀为『.gz』的压缩文件。（我的 SD 卡是 32G 的，生成出来的备份文件是 19.32G，解压后是 31.72G）</p>
<h3 id="还原"><a href="#还原" class="headerlink" title="还原"></a>还原</h3><p>还原的操作和装系统其实差不多。</p>
<p>把之前备份下来的系统压缩文件解压后，拿到一个无后缀名的文件。</p>
<p>解压：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gzip -d system_save_14_04_24.gz</div></pre></td></tr></table></figure>
<p>拿到解压出来的文件后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo diskutil unmount /dev/disk2s1</div><div class="line">sudo dd bs=4m if=system_save_14_04_24 of=/dev/rdisk2</div></pre></td></tr></table></figure>
<p>成功之后，把 SD 卡插入树莓派，开机。</p>
<p>就可以正常像刚备份过后一样正常使用了。</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Kommentare:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                   
                        <li>
                            <a href="https://github.com/ChinaSunHZ/" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="http://weibo.com/shz272119494" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://twitter.com/ChinaSunHZ" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.facebook.com/ChinaSunHZ" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://cn.linkedin.com/in/浩臻-孙-0208ba94" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="mailto:China.SunhZ@Gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <!--
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
                -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'spencer-dev-com';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>