<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="作者：给立乐*出处：http://spencer-dev.com/2016/11/12/Clean Code - Chapter 4  注释声明：本文采用以下协议进行授权： 自由转载-非商用-非衍生-保持署名|Creative Commons BY-NC-ND 3.0 ，转载请注明作者及出处。
“别">
    

    <!--Author-->
    
        <meta name="author" content="Spencer">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Clean Code - Chapter 4  注释"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="给立乐*"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Clean Code - Chapter 4  注释 - 给立乐*</title>

    <!-- Bootstrap Core CSS -->
    <link href="http://7xjqw5.com1.z0.glb.clouddn.com/theme/css/bootstrap-3.3.6.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="http://7xjqw5.com1.z0.glb.clouddn.com/theme/css/font-awesome-4.6.3.min.css" rel="stylesheet" type="text/css">
    
    <!-- <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"> -->
    <link href="http://7xjqw5.com1.z0.glb.clouddn.com/theme/css/google-font-1.css" rel="stylesheet" type="text/css">
    
    <!-- <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"> -->
    <link href="http://7xjqw5.com1.z0.glb.clouddn.com/theme/css/google-font-2.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="http://7xjqw5.com1.z0.glb.clouddn.com/theme/css/featherlight-1.3.5.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-65158169-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">给立乐* Android 开发者</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/ChinaSunHZ/">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://7xjqw5.com1.z0.glb.clouddn.com/theme/image/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Clean Code - Chapter 4  注释</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2016-11-12 21:44
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/Clean-Code/">#Clean Code</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>作者：给立乐*<br>出处：<a href="http://spencer-dev.com/2016/11/12/Clean Code - Chapter 4  注释">http://spencer-dev.com/2016/11/12/Clean Code - Chapter 4  注释</a><br>声明：本文采用以下协议进行授权： 自由转载-非商用-非衍生-保持署名|<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" rel="external">Creative Commons BY-NC-ND 3.0</a> ，转载请注明作者及出处。</p>
<p>“别给糟糕的代码加注释 － 重新写吧” —— Brian W. Kernaghan 与 P.J.Plaugher。</p>
<p>什么也比不上放置良好的代码来的有用。什么也不会比乱七八糟的注释更有本事搞乱一个模块。什么也不会比陈旧、提供错误信息的注释更有破坏性。</p>
<p>注释的恰当用法是弥补我们在用代码表达意图时遭遇的失败。</p>
<h1 id="我为什么要极力贬低注释？"><a href="#我为什么要极力贬低注释？" class="headerlink" title="我为什么要极力贬低注释？"></a>我为什么要极力贬低注释？</h1><p>因为注释会撒谎。注释存在的时间越久，就离其所描述的代码越远，越来越变的全然错误。原因很简单。程序员不能坚持维护注释。</p>
<p>代码在变动，在演化。从这里移到那里。彼此分离，重造又合到一处。很不幸，注释并不总是随之变动——不能总是跟着走。注释常常会与其所描述的代码分隔开来，孑然飘零，越来越不准确。</p>
<p>程序员应当负责将注释保持在可维护、精确的高度。我同意这种说法。但我更主张把力气用在写清楚代码上，直接保证无需编写注释。</p>
<p>不准确的注释要比没注释坏的多。它们满口胡言。它们预期的东西永远不能实现。它们设定了无需也不应在遵循的旧规则。</p>
<p>真想只在一处地方有：代码。只有代码能忠实地告诉你它做的事。那是唯一真正准确的信息来源。所以，尽管有时也需要注释，我们也该多花心思尽量减少注释量。</p>
<h1 id="注释不能美化糟糕的代码"><a href="#注释不能美化糟糕的代码" class="headerlink" title="注释不能美化糟糕的代码"></a>注释不能美化糟糕的代码</h1><p>写注释的常见动机之一是糟糕的代码的存在。我们告诉自己：“喔，最好写点注释！” 不！最好是把代码弄干净！</p>
<p>带有少量注释的整洁而有表达力的代码，要比带有大量注释的零碎而复杂的代码像样的多。与其花时间编写解释你搞出的糟糕代码的注释，不如花时间清洁那堆糟糕的代码。</p>
<h1 id="用代码来阐述"><a href="#用代码来阐述" class="headerlink" title="用代码来阐述"></a>用代码来阐述</h1><p>有时，代码本身不足以解释其行为。</p>
<p>比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Check to see if the employee is eligible for full benefits</span></div><div class="line"><span class="keyword">if</span>((employee.flags &amp; HOURLY_FLAG) &amp;&amp; (employee.age &gt; <span class="number">65</span>))</div></pre></td></tr></table></figure>
<p>其实只需要想上哪么几秒钟，就能用代码解释大部分意图。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(employee.isEligibleForFullBenefits())</div></pre></td></tr></table></figure>
<p>很多时候，简单到需要创建一个描述与注释所言同一事物的函数即可。</p>
<hr>
<h1 id="好注释"><a href="#好注释" class="headerlink" title="好注释"></a>好注释</h1><p>有些注释是必须的，也是有利的。但真正好的注释是你想办法不去写注释。下面看一些值得写的注释。</p>
<h2 id="法律信息"><a href="#法律信息" class="headerlink" title="法律信息"></a>法律信息</h2><p>有时，公司代码规范要求编写与法律有关的注释。例如，版权及著作权声明就是必须和有理由在每个源文件开头注释处放置的内容。</p>
<p>这类注释不应是合同或法典。只要有可能，就只想一份标准许可或其它外部文档，而不要把所有条款放到注释中。</p>
<h2 id="提供信息的注释"><a href="#提供信息的注释" class="headerlink" title="提供信息的注释"></a>提供信息的注释</h2><p>有时，用注释来提供基本信息也有其用处。</p>
<p>例如，以下注释解释了某个抽象方法的返回值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Returns an instance of the Responder being tested</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Responder <span class="title">responderInstance</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure>
<p>这类注释有时管用，但更好的方式是尽量利用函数名称传达信息。</p>
<p>比如，在本例中，只要把函数重命名为 responderBeingTested，注释就是多余的了。</p>
<h2 id="对意图的解释"><a href="#对意图的解释" class="headerlink" title="对意图的解释"></a>对意图的解释</h2><p>有时，注释不仅提供了有关实现的有用信息，而且还提供了某些后续的意图。</p>
<h2 id="阐释"><a href="#阐释" class="headerlink" title="阐释"></a>阐释</h2><p>有时，注释把某些晦涩难明的参数或返回值的意义翻译为某种可读形式，也会是有用的。通常，更好的方法是尽量让参数或返回值自身就足够清楚；但如果参数或返回值是某个标准库的一部分，或是你不能修改的代码，帮助阐释其含义就会很有用。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCompareTo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">  WikiPagePath a = PathParser.parse(<span class="string">"PageA"</span>);</div><div class="line">  WikiPagePath ab = PathParser.parse(<span class="string">"PageA.PageB"</span>);</div><div class="line">  </div><div class="line">  asserTrue(a.compareTo(a) == <span class="number">0</span>); <span class="comment">// a == a</span></div><div class="line">  asserTrue(ab.compareTo(ab) == <span class="number">0</span>); <span class="comment">// ab == ab</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然，这也会冒着阐释性注释本身就不正确的风险。回头看看上例，你会发现想要确认注释的正确性有多难。这一方面说明了阐释有多必要，另外也说明了它有风险。所以，在写这类注释之前，考虑一下是否还有更好的办法，然后再加倍小心地确认注释正确性。</p>
<h2 id="警示"><a href="#警示" class="headerlink" title="警示"></a>警示</h2><p>有时，用于警告其他程序员会出现某种后果的注释也是有用的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Don`t run unless you</span></div><div class="line"><span class="comment">// have some time to kill.</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">_testWithReallyBigFile</span><span class="params">()</span> </span>&#123;</div><div class="line">  writeLinesToFile(<span class="number">10000000</span>);</div><div class="line">  response.setBody(testFile);</div><div class="line">  response.readyToSend(<span class="keyword">this</span>);</div><div class="line">  String responseString = output.toString();</div><div class="line">  assertSubString(<span class="string">"Content-Length:1000000000"</span>);</div><div class="line">  assertTrue(bytesSent &gt; <span class="number">1000000000</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="TODO-注释"><a href="#TODO-注释" class="headerlink" title="TODO 注释"></a>TODO 注释</h2><p>有时，有理由用 // TODO 形式在源代码中放置要做的工作列表。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// TODO-MdM these are not needed</span></div><div class="line"><span class="comment">// We expect this to go away when we do the checkout model</span></div><div class="line"><span class="function"><span class="keyword">protected</span> VersionInfo <span class="title">makeVersion</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>TODO 是一种程序员认为应该做，但由于某些原因目前还没做的工作。它可能是要提醒删除某个不必要的特性，或者要求他人注意某个问题。它可能是恳请别人取个好名字，或者对提示依赖于某个计划事件的修改。无论 TODO 的目的如何，它都不是在系统中留下糟糕代码的借口。</p>
<p>如今，大多数的 IDE 都提供了特别的手段来定位所有 TODO 注释，这些注释看来丢不了。你不会愿意代码因为 TODO 的存在而变成一堆垃圾，所以要定期查看，删除不再需要的。</p>
<h2 id="放大"><a href="#放大" class="headerlink" title="放大"></a>放大</h2><p>注释可以用来放大某种看来不合理之物的重要性。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">String listItemContent = match.group(<span class="number">3</span>).trim();</div><div class="line"><span class="comment">// he trim is real important. It removes the starting</span></div><div class="line"><span class="comment">// spaces that could cause the item to be recognized</span></div><div class="line"><span class="comment">// as another list.</span></div><div class="line"><span class="keyword">new</span> ListItemWidget(<span class="keyword">this</span>, listItemContent, <span class="keyword">this</span>.level + <span class="number">1</span>);</div><div class="line"><span class="keyword">return</span> buildList(text.subString(match.end()));</div></pre></td></tr></table></figure>
<h2 id="公共-API-中的-Javadoc"><a href="#公共-API-中的-Javadoc" class="headerlink" title="公共 API 中的 Javadoc"></a>公共 API 中的 Javadoc</h2><p>如果你在编写公共 API，就该为他编写良好的 Javadoc。不过要记住本章中的其他建议。就像其他注释一样，Javadoc 也可能误导、不适用或者提供错误信息。</p>
<hr>
<h1 id="坏注释"><a href="#坏注释" class="headerlink" title="坏注释"></a>坏注释</h1><p>大多数注释都属此类。通常，坏注释都是糟糕代码的支撑或借口，或者对错误决策的修正，基本上等于程序员的自说自话。</p>
<h2 id="喃喃自语"><a href="#喃喃自语" class="headerlink" title="喃喃自语"></a>喃喃自语</h2><p>如果只是因为你觉得应该或因为过程需要就添加注释，那就是无谓之举。如果你决定写注释，就要花必要的事件来确保写出最好的注释。</p>
<p>任何迫使读者查看其他模块的注释，都没能与读者沟通好，不值所费。 </p>
<h2 id="多余的注释"><a href="#多余的注释" class="headerlink" title="多余的注释"></a>多余的注释</h2><p>下面这段代码是一个简单的函数，其头部位置的注释全属多余。读这段注释花的时间没准比读代码花的时间还长。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Utility method that returns when this. closed is true. Throws an exception</span></div><div class="line"><span class="comment">// if the timeout is reached.</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">waitForClose</span><span class="params">(<span class="keyword">final</span> <span class="keyword">long</span> timeoutMillis)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">  <span class="keyword">if</span>(!closed) &#123;</div><div class="line">    wait(timeoutMillis);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(!closed) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"MockResponseSender could not be closed"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这段注释起了什么作用？它并不能比代码本身提供更多的信息。他没有证明代码的意义，也没有给出代码的意图或逻辑。读它并不比读代码更容易。事实上，它不如代码精确，还误导读者接受不精确的信息，而不是正确的理解代码。</p>
<p>下面来看看摘自 Tomcat 项目的无用而多余的 Javadoc。这些注释只是一味将代码搞的含糊不明。完全没有文档上的价值。</p>
<p>ContainerBase.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ContainerBase</span> <span class="keyword">implements</span> <span class="title">Container</span>, <span class="title">Lifecycle</span>, <span class="title">Pipeline</span>, <span class="title">MBeanRegistration</span>, <span class="title">Serializable</span> </span>&#123;</div><div class="line">  <span class="comment">/**</span></div><div class="line">  * The processor delay for this component.</div><div class="line">  */</div><div class="line">  <span class="keyword">protected</span> <span class="keyword">int</span> backgroundProcessorDelay = -<span class="number">1</span>;</div><div class="line">  <span class="comment">/**</span></div><div class="line">  * The lifecycle event support for this component.</div><div class="line">  */</div><div class="line">  <span class="keyword">protected</span> LifecycleSupport lifecycle = <span class="keyword">new</span> LifecyclesSupport(<span class="keyword">this</span>);</div><div class="line">  <span class="comment">// .... </span></div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="误导性注释"><a href="#误导性注释" class="headerlink" title="误导性注释"></a>误导性注释</h2><p>有时，尽管初中可嘉，程序员还是会写出不够精确的注释。一些细微的误导信息，放在比代码本身更难阅读的注释里面，有可能导致其他程序员快活地调用函数，这位可怜的程序员将会发现自己陷于调试的困境之中。</p>
<h2 id="循规式注释"><a href="#循规式注释" class="headerlink" title="循规式注释"></a>循规式注释</h2><p>所谓每个函数都要有 Javadoc 或每个变量都要有注释的规矩全然是愚蠢可笑的。这类注释徒然让代码变得散乱，满口胡言，令人迷惑不解。这类废话只会搞乱代码，有可能误导读者。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">  *</div><div class="line">  * <span class="doctag">@param</span> title The title of the CD</div><div class="line">  * <span class="doctag">@param</span> author The author of the CD</div><div class="line">  * <span class="doctag">@param</span> tracks The number of tracks on the CD</div><div class="line">  * <span class="doctag">@param</span> durationInMinutes The duration of the CD in minutes</div><div class="line">  */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCD</span><span class="params">(String title, String author, <span class="keyword">int</span> tracks, <span class="keyword">int</span> durationInMinutes)</span> </span>&#123;</div><div class="line">  CD cd = <span class="keyword">new</span> CD();</div><div class="line">  cd.title = title;</div><div class="line">  cd.author = author;</div><div class="line">  cd.tracks = tracks;</div><div class="line">  cd.duration = duration;</div><div class="line">  cdList.add(cd);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="日志式注释"><a href="#日志式注释" class="headerlink" title="日志式注释"></a>日志式注释</h2><p>有人会在每次编辑代码时，在模块开始处添加一条注释。这类注释就像是一种记录每次修改的日志。</p>
<p>很久以前，在模块开始处创建并维护这些记录还算有道理。那时，我们还没有源代码控制系统可用。如今，这种冗长的记录只会让模块变得凌乱不堪，应当全部删除。</p>
<h2 id="废话注释"><a href="#废话注释" class="headerlink" title="废话注释"></a>废话注释</h2><p>有时，你会看到纯然是废话的注释。它们对于显然之事喋喋不休，毫无新意。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">  * Default constructor.</div><div class="line">  */</div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="title">AnnualDateRule</span><span class="params">()</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** The day of the month. */</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">int</span> dayOfMonth;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">  * Returns the day of the month.</div><div class="line">  *</div><div class="line">  * <span class="doctag">@return</span> the day of the month.</div><div class="line">  */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDayOfMonth</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> dayOfMonth;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这类注释废话连篇，我们都学会了视而不见。读代码时，眼光不会停留在它们上面。最终，当代码修改之后，这类注释就变作了谎言一堆。</p>
<p>下面代码中，第一条注释貌似还行。它解释了 catch 代码块为何被忽略。不过第二条注释就是纯废话了。显然，该程序员沮丧于编写函数中的那些 try/catch 代码块。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startSending</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">try</span></div><div class="line">  &#123;</div><div class="line">    doSending();</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span>(SocketException e)</div><div class="line">  &#123;</div><div class="line">    <span class="comment">// normal. someone stopped the request.</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span>(Exception e)</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">try</span></div><div class="line">    &#123;</div><div class="line">      response.add(ErrorResponser.makeExceptionString(e));</div><div class="line">      response.closeAll();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">catch</span>(Exception e1)</div><div class="line">    &#123;</div><div class="line">      <span class="comment">// Give me a break!</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>与其纠缠于毫无价值的废话注释，程序员应该意识到，他的挫败感可以由改进代码结构而消除。他应该把力气花在将最末一个 try/catch 代码块拆解到单独的函数中，如下所示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startSending</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">try</span></div><div class="line">  &#123;</div><div class="line">    doSending();</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span>(SocketException e)</div><div class="line">  &#123;</div><div class="line">    <span class="comment">// normal. someone stopped the request.</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span>(Exception e)</div><div class="line">  &#123;</div><div class="line">    addExceptionAndCloseResponse(e);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addExceptionAndCloseResponse</span><span class="params">(Exception e)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">try</span></div><div class="line">  &#123;</div><div class="line">    response.add(ErrorResponder.makeExceptionString(e));</div><div class="line">    response.closeAll();</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span>(Exception e1)</div><div class="line">  &#123;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用整理代码的决心替代创造废话的冲动。你会发现自己成为更优秀、更快乐的程序员。</p>
<h2 id="可怕的废话"><a href="#可怕的废话" class="headerlink" title="可怕的废话"></a>可怕的废话</h2><p>Javadoc 也有可能是废话。下列 Javadoc（来自某知名开源库）的目的是什么？答案：无。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** The name.*/</span></div><div class="line"><span class="keyword">private</span> String name;</div><div class="line"><span class="comment">/** The version.*/</span></div><div class="line"><span class="keyword">private</span> String version;</div><div class="line"><span class="comment">/** The licenceName.*/</span></div><div class="line"><span class="keyword">private</span> String licenceName;</div><div class="line"><span class="comment">/** The version.*/</span></div><div class="line"><span class="keyword">private</span> String info;</div></pre></td></tr></table></figure>
<p>再仔细读读这些注释。你是否发现了剪切－粘贴错误？如果作者在写（或粘贴）注释时都没花心思，怎么能指望读者从中获益呢？</p>
<h2 id="能用函数或变量时就别用注释"><a href="#能用函数或变量时就别用注释" class="headerlink" title="能用函数或变量时就别用注释"></a>能用函数或变量时就别用注释</h2><p>看看以下代码概要：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// does the module from the global list &lt;mod&gt; depend on the</span></div><div class="line"><span class="comment">// subsystem we are part of?</span></div><div class="line"><span class="keyword">if</span>(smodule.getDependSubsystems().contains(SubSysMod.getSubSystem())) &#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以改成一下没有注释的版本：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ArrayList moduleDependees = smodule.getDependSubsystems();</div><div class="line">String ourSubSystem = subSysMod.getSubSystem();</div><div class="line"><span class="keyword">if</span>(moduleDependees.contains(ourSubSystem)) &#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="位置标记"><a href="#位置标记" class="headerlink" title="位置标记"></a>位置标记</h2><p>有时，程序员喜欢早源代码中标记某个特别的位置。例如我最近在程序中看到这样一行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Actions /////////////////////////////////////////////</span></div></pre></td></tr></table></figure>
<p>把特定函数趸放在这种标记栏下面，多数时候实属无理。鸡零狗碎，理当删除 － 特别是尾部那一长串无用的斜杠。</p>
<p>这么说吧。如果标记栏不多，就会显而易见。所以，尽量少用标记栏，只在特别有价值的时候用。如果滥用标记栏，就会沉默在背景噪音中，被忽略掉。</p>
<h2 id="括号后面的注释"><a href="#括号后面的注释" class="headerlink" title="括号后面的注释"></a>括号后面的注释</h2><p>有时，程序员会在括号后面放置特殊的注释，如下面代码所示。</p>
<p>尽管这对于含有深度嵌套结构的长函数可能有意义，但只会给我们愿意编写的短小、封装的函数带来混乱。如果你发现自己想标记右括号，其实应该做的是缩短函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wc</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="comment">// ....</span></div><div class="line">      <span class="keyword">while</span>((line = in.readLine()) != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="comment">// ....</span></div><div class="line">      &#125; <span class="comment">// while</span></div><div class="line">    &#125; <span class="comment">// try</span></div><div class="line">    <span class="keyword">catch</span>(IOException e) &#123;</div><div class="line">      <span class="comment">// ....</span></div><div class="line">    &#125; <span class="comment">// catch</span></div><div class="line">  &#125; <span class="comment">// main</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="归属与署名"><a href="#归属与署名" class="headerlink" title="归属与署名"></a>归属与署名</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* Added by Rick */</span></div></pre></td></tr></table></figure>
<p>源代码控制系统非常善于记住是谁在何时添加了什么。没必要用那些小小的签名搞脏代码。你也许会认为，这种注释大概有助于他人了解和谁讨论这段代码。不过，事实却是注释在那儿放了一年又一年，越来越不准确，越来越和原作者没关系。</p>
<p>重申一下，源代码控制系统是这类信息最好的归属地。</p>
<h2 id="注释掉的代码"><a href="#注释掉的代码" class="headerlink" title="注释掉的代码"></a>注释掉的代码</h2><p>直接把代码注释掉是讨厌的做法。别这么干！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">InputStreamResponse response = <span class="keyword">new</span> InputStreamResponse();</div><div class="line">response.setBody(formatter.getResultStream(), formatter.getByteCount());</div><div class="line"><span class="comment">// InputStream resultsStream = formatter.getResultStream();</span></div><div class="line"><span class="comment">// StreamReader reader = new StreamReader(resultsStream);</span></div><div class="line"><span class="comment">// response.setContent(reader.read(formatter.getByteCount()));</span></div></pre></td></tr></table></figure>
<p>其他人不敢删除注释掉的代码。他们会想，代码依然放在那儿，一定有其原因，而且这段代码很重要，不能删除。注释掉的代码堆积在一起，就像破酒瓶底掉渣在一般。</p>
<p>代码为什么要注释掉？它们重要吗？它们搁在那儿，是为了给未来的修改做提示吗？或者，只是某人在多年以前注释掉、懒得清理的过时玩意儿？</p>
<p>20世纪60年代，曾经有那么一段时间，注释掉的代码可能有用。但我们已经拥有了优良的源代码控制系统如此之久，这些系统可以为我们记住不要的代码。我们无需再用注释来标记，删掉即可，它们丢不了。</p>
<h2 id="HTML-注释"><a href="#HTML-注释" class="headerlink" title="HTML 注释"></a>HTML 注释</h2><p>源代码注释中的 HTML 标签是一种厌恶。编辑器／IDE 中的代码本来易于阅读，却因为 HTML 注释的存在变得难以卒读。如果注释将由某种工具（例如 Javadoc）抽取出来，呈现到网页，那么该是工具而非程序员来负责给注释加上合适的 HTML 标签。</p>
<h2 id="非本地信息"><a href="#非本地信息" class="headerlink" title="非本地信息"></a>非本地信息</h2><p>假如你一定要写注释，请确保它描述了离它最近的代码。别再本地注释的上下文环境中给出系统级的信息。</p>
<h2 id="信息过多"><a href="#信息过多" class="headerlink" title="信息过多"></a>信息过多</h2><p>别再注释中添加有趣的历史性话题或无关的细节描述。</p>
<h2 id="不明显的联系"><a href="#不明显的联系" class="headerlink" title="不明显的联系"></a>不明显的联系</h2><p>注释及其描述的代码之间的联系应该是显而易见的。如果你不嫌麻烦要写注释，至少要让读者能看着注释和代码，并理解注释所谈何物。</p>
<p>注释的作用是解释未能自行解释的代码。如果注释本身还需要解释，那就太遗憾了。</p>
<h2 id="函数头"><a href="#函数头" class="headerlink" title="函数头"></a>函数头</h2><p>短函数不需要太多描述。为只做一件事的短函数选个好名字，通常要比写函数头注释要好。</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Kommentare:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">

                   
                        <li>
                            <a href="https://github.com/ChinaSunHZ/" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="http://weibo.com/shz272119494" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://twitter.com/ChinaSunHZ" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.facebook.com/ChinaSunHZ" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://cn.linkedin.com/in/浩臻-孙-0208ba94" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="mailto:China.SunhZ@Gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <!--
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
                -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="http://7xjqw5.com1.z0.glb.clouddn.com/theme/js/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="http://7xjqw5.com1.z0.glb.clouddn.com/theme/js/bootstrap-3.3.6.min.js"></script>

<!-- Gallery -->
<script src="http://7xjqw5.com1.z0.glb.clouddn.com/theme/js/featherlight-1.3.5.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'spencer-dev-com';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>